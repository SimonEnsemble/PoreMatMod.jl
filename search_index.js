var documenterSearchIndex = {"docs":
[{"location":"manual/start/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"","category":"section"},{"location":"manual/start/#Installation","page":"Getting Started","title":"Installation","text":"","category":"section"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"Download and install the Julia programming language, v1.6 or higher.","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"To install PoreMadMod.jl (officially registered as a Julia package), in the Julia REPL, enter the package manager by typing ] and enter:","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"pkg> add PoreMatMod","category":"page"},{"location":"manual/start/#Loading-the-PoreMatMod.jl-package","page":"Getting Started","title":"Loading the PoreMatMod.jl package","text":"","category":"section"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"To load the PoreMatMod.jl package, so that its functions are imported into your namespace, in your Julia code:","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"julia> using PoreMatMod","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"We recommend writing Julia code and performing find-and-replace tasks with PoreMadMod.jl using interactive Pluto notebooks.","category":"page"},{"location":"manual/start/#Running-tests-(optional)","page":"Getting Started","title":"Running tests (optional)","text":"","category":"section"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"Run the unit tests associated with PoreMatMod.jl by entering package mode in the Julia REPL via (]) and entering:","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"pkg> test PoreMatMod","category":"page"},{"location":"manual/start/","page":"Getting Started","title":"Getting Started","text":"note: Note\nPoreMatMod.jl is built on Xtals.jl, which provides:the data structure and reader, Crystal, for crystal structures \nthe infer_bonds! function that assigns bonds between atoms of a Crystal","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"DocTestSetup = quote\n    using PoreMatMod\n    parent = Crystal(\"IRMOF-1.cif\")\n    infer_bonds!(parent, true)\nend","category":"page"},{"location":"manual/replace/#Find/Replace-Operations","page":"Substructure Find/Replace","title":"Find/Replace Operations","text":"","category":"section"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"(Image: replacement scheme)","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"To do a find-and-replace, we perform a search using a query with masked atoms, denoted by appending their chemical species label with ! (see above). Masking an atom allows its species to change or for it to be deleted during the replacement.","category":"page"},{"location":"manual/replace/#Inputs","page":"Substructure Find/Replace","title":"Inputs","text":"","category":"section"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"To guide replacement, the .xyz file input for the search moiety must be altered.   Simply adding ! after the atomic symbol tags that atom for replacement. The atom property viewer feature in iRASPA is conducive to this task.","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"In the example of finding and replacing the 2 position H of the p-phenylene moieties of IRMOF-1, the input should have one H atom tagged, like so:","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"H!         1.06706        0.70670        1.48683","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"Load the new file in like before and execute the search. The ! tag does not affect the outcome of substructure_search.","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"query = moiety(\"2-!-p-phenylene.xyz\")\nsearch = query in parent","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"To replace p-phenylene moieties with 2-acetylamido-p-phenylene moieties, load 2-acetylamido-p-phenylene.xyz:","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"replacement = moiety(\"2-acetylamido-p-phenylene.xyz\")","category":"page"},{"location":"manual/replace/#Simple-Syntax","page":"Substructure Find/Replace","title":"Simple Syntax","text":"","category":"section"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"Generally, it is advisable to perform the search and use substructure_replace, as multiple replacement tasks can be performed with a single searching step. The search is usually the slowest step, and it is desirable not to perform it repeatedly. However, for one-shot find-and-replace operations, the standard replace function syntax may be used:","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"replace(parent, query => replacement)","category":"page"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"To direct the number, location, and orientation of the replacements made, use the keyword arguments for substructure_replace.","category":"page"},{"location":"manual/replace/#Documentation-of-functions","page":"Substructure Find/Replace","title":"Documentation of functions","text":"","category":"section"},{"location":"manual/replace/","page":"Substructure Find/Replace","title":"Substructure Find/Replace","text":"substructure_replace","category":"page"},{"location":"manual/replace/#PoreMatMod.substructure_replace","page":"Substructure Find/Replace","title":"PoreMatMod.substructure_replace","text":"substructure_replace(search, replacement, nb_loc=2)\n\nInserts replacement into a parent structure according to search and kwargs. Provide a replacement style kwarg to direct the location and orientation of replacements. Default behavior is to seek the replacement operation with lowest RMSD on spatial alignment. Returns a new Crystal with the specified modifications (returns search.parent if no replacements are made)\n\nArguments\n\nsearch::Search the Search for a substructure moiety in the parent crystal\nreplacement::Crystal the moiety to use for replacement of the searched substructure\nrandom::Bool set true to select random replacement orientations\nnb_loc::Int assign a value to select random replacement at nb_loc random locations\nloc::Array{Int} assign value(s) to select specific locations for replacement.  If ori is not specified, replacement orientation is random.\nori::Array{Int} assign value(s) when loc is assigned to specify exact configurations for replacement. 0 values mean the configuration at that location should be selected for optimal alignment with the parent.\nname::String assign to give the generated Crystal a name (\"new_xtal\" by default)\nverbose::Bool set true to print console messages about the replacement(s) being performed\n\n\n\n\n\n","category":"function"},{"location":"collab/#Contributing/Reporting-Issues","page":"Contribute/Report Issues","title":"Contributing/Reporting Issues","text":"","category":"section"},{"location":"collab/#Reporting-Issues","page":"Contribute/Report Issues","title":"Reporting Issues","text":"","category":"section"},{"location":"collab/","page":"Contribute/Report Issues","title":"Contribute/Report Issues","text":"Please report any bugs or make suggestions for improvements by filing an issue on Github here.","category":"page"},{"location":"collab/#PoreMatMod.jl-Wants-You!","page":"Contribute/Report Issues","title":"PoreMatMod.jl Wants You!","text":"","category":"section"},{"location":"collab/","page":"Contribute/Report Issues","title":"Contribute/Report Issues","text":"We welcome contributions (pull requests) for bug fixes, improvements, new features, etc. If the change is fundamental/major, please post an issue to discuss first.","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"DocTestSetup = quote\n    using PoreMatMod\nend","category":"page"},{"location":"manual/inputs/#Reading-data-from-crystal-structure-and-chemical-fragment-files-into-PoreMatMod.jl","page":"Loading Data","title":"Reading data from crystal structure and chemical fragment files into PoreMatMod.jl","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"This section details how to load data into PoreMatMod.jl, including the handling of paths to data and input file formats.","category":"page"},{"location":"manual/inputs/#Crystal-structures","page":"Loading Data","title":"Crystal structures","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"Accepted file formats for crystal structures (containing atomic coordinates and unit cell information) are .cif and .cssr. See here for information about CIF files.","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"Crystal structure files (.cif, .cssr) are read from the path rc[:paths][:crystals].","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"example: Example\nRead in the crystal structure of IRMOF-1.cif and infer its bonding network:parent = Crystal(\"IRMOF-1.cif\")\ninfer_bonds!(parent, true) # true b/c we want periodic bonds included","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"The Crystal constructor returns a Crystal data structure. The infer_bonds! function is necessary because it infers the bonding graph of the crystal structure (nodes: atoms, edges: bonds) based on interatomic distances. Both Crystal and infer_bonds! are inherited from Xtals.jl (see the docs). ","category":"page"},{"location":"manual/inputs/#Query-and-Replacement-Fragments","page":"Loading Data","title":"Query and Replacement Fragments","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"Accepted file formats for chemical fragments (list of atoms and their Cartesian coordinates) are .xyz. See here for information about XYZ files. ","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"Query and replacement fragment files (.xyz) are read from the path rc[:paths][:moieties].","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"N.b. masked atoms of query fragments must be labeled with ! for replace operations. For substructure searches using substructure_search, any ! tags are ignored (the atoms are treated according to their chemical species).","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"example: Example\nRead in the chemical fragment p-phenylene.xyz:query = moiety(\"p-phenylene.xyz\")","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"The moiety reader also returns a Crystal data structure but with an arbitrary unit cube unit cell.","category":"page"},{"location":"manual/inputs/#Changing-the-Data-Directories","page":"Loading Data","title":"Changing the Data Directories","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"rc[:paths][:crystals] and rc[:paths][:moieties] default to ./data/crystals and ./data/moieties, respectively.","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"To change the paths from where the files are read, change rc[:paths][:crystals] and rc[:paths][:moieties].","category":"page"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"example: Example\nSuppose we wish to store our .cif files in ~/my_xtals and our .xyz files in our present working directory.rc[:paths][:crystals] = joinpath(homedir(), \"my_xtals_folder\")\nrc[:paths][:moiety] = pwd()                                  ","category":"page"},{"location":"manual/inputs/#Other-data","page":"Loading Data","title":"Other data","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"PoreMatMod.jl draws atomic masses and covalent radii from Xtals.jl.","category":"page"},{"location":"manual/inputs/#Detailed-documentation-for-functions","page":"Loading Data","title":"Detailed documentation for functions","text":"","category":"section"},{"location":"manual/inputs/","page":"Loading Data","title":"Loading Data","text":"moiety\nCrystal\ninfer_bonds!\nBondingRule\nstrip_numbers_from_atom_labels!","category":"page"},{"location":"manual/inputs/#PoreMatMod.moiety","page":"Loading Data","title":"PoreMatMod.moiety","text":"moiety(xyz_filename)\n\nGenerates a moiety (Crystal) from an .xyz file found in rc[:paths][:moieties].\n\nUse set_path_to_data or set rc[:paths][:moieties] to change the path from which the XYZ file is read.\n\nAtoms appended with '!' are tagged for replacement via substructure_replace.\n\nBonds are inferred automatically via infer_bonds!.\n\nArguments\n\nxyz_filename::Union{String,Nothing} the moiety input file name, an .xyz file; if set to nothing the moiety is the null set.\nbonding_rules::Union{Vector{BondingRule},Nothing} (optional) a list of rules to use for inferring the bonding network of the atoms loaded from the XYZ file. If set to nothing, the default rules are used.\n\n\n\n\n\n","category":"function"},{"location":"manual/inputs/#Xtals.Crystal","page":"Loading Data","title":"Xtals.Crystal","text":"crystal = Crystal(filename;\n    check_neutrality=true, net_charge_tol=1e-4,\n    check_overlap=true, convert_to_p1=true, \n    read_bonds_from_file=false, wrap_coords=true,\n    include_zero_charges=true,\n    remove_duplicates=false,\n    species_col=[\"_atom_site_type_symbol\", \"_atom_site_label\"]\n    ) # read from file\n\ncrystal = Crystal(name, box, atoms, charges) # construct from matter, no bonds, P1-symmetry assumed\n\nRead a crystal structure file (.cif or .cssr) and populate a Crystal data structure, or construct a Crystal data structure directly.\n\nArguments\n\nfilename::String: the name of the crystal structure file (include \".cif\" or \".cssr\") read from PATH_TO_CRYSTALS.\ncheck_neutrality::Bool: check for charge neutrality\nnet_charge_tol::Float64: when checking for charge neutrality, throw an error if the absolute value of the net charge is larger than this value.\ncheck_overlap::Bool: throw an error if overlapping atoms are detected.\nconvert_to_p1::Bool: If the structure is not in P1 it will be converted to   P1 symmetry using the symmetry rules from the _symmetry_equiv_pos_as_xyz list in the .cif file.   (We do not use the space groups name to look up symmetry rules).\nread_bonds_from_file::Bool: Whether or not to read bonding information from   cif file. If false, the bonds can be inferred later. note that, if the crystal is not in P1 symmetry, we cannot both read bonds and convert to P1 symmetry.\nwrap_coords::Bool: if true, enforce that fractional coords of atoms and charges are in [0,1]³ by mod(x, 1)\ninclude_zero_charges::Bool: if false, do not include in crystal.charges atoms which have zero charges, in order to speed up the electrostatic calculations.   If true, include the atoms in crystal.charges that have zero charge, ensuring that the number of atoms is equal to the number of charges and that crystal.charges.coords.xf and crystal.atoms.coords.xf are the same.\nremove_duplicates::Bool: remove duplicate atoms and charges. an atom is duplicate only if it is the same species.\nspecies_col::Array{String}: which column to use for species identification for crystal.atoms.species. we use a priority list:   we check for the first entry of species_col in the .cif file; if not present, we then use the second entry, and so on.\ninfer_bonds::Union{Symbol, Missing}: if set, bonds are inferred according to the chosen method (:cordero or :voronoi). If set, must specify periodic_boundaries. By default, bonds are not inferred.\nperiodic_boundaries::Union{Bool, Missing}: use with infer_bonds to specify treatment of the unit cell boundary.  Set true to treat the unit cell edge as a periodic boundary (allow bonds across it); set false to restrict bonding to within the local unit cell.\n\nacross periodic unit cell boundaries; if false, bonds are only inferred within the local unit cell; if missing (default), bonds are not inferred.\n\nReturns\n\ncrystal::Crystal: A crystal containing the crystal structure information\n\nAttributes\n\nname::AbstractString: name of crystal structure\nbox::Box: unit cell (Bravais Lattice)\natoms::Atoms: list of Atoms in crystal unit cell\ncharges::Charges: list of point charges in crystal unit cell\nbonds::MetaGraph: Unweighted, undirected graph showing all of the atoms   that are bonded within the crystal\nsymmetry::SymmetryInfo: symmetry inforomation\n\n\n\n\n\n","category":"type"},{"location":"manual/inputs/#Xtals.infer_bonds!","page":"Loading Data","title":"Xtals.infer_bonds!","text":"infer_bonds!(crystal, include_bonds_across_periodic_boundaries; bonding_rules=rc[:bonding_rules])\n\nPopulate the bonds in the crystal object based on the bonding rules. If a pair doesn't have a suitable rule then they will not be considered bonded.\n\n:* is considered a wildcard and can be substituted for any species. It is a good idea to include a bonding rule between two :* to allow any atoms to bond as long as they are close enough.\n\nThe bonding rules are hierarchical, i.e. the first bonding rule takes precedence over the latter ones.\n\nArguments\n\ncrystal::Crystal: The crystal that bonds will be added to.\ninclude_bonds_across_periodic_boundaries::Bool: Whether to check across the periodic boundary when calculating bonds.\nbonding_rules::Array{BondingRule, 1}: The array of bonding rules that will be used to fill the bonding information. They are applied in the order that they appear. rc[:bonding_rules] will be used if none provided.\ncalculate_vectors::Bool: Optional. Set true to annotate all edges in the bonds graph with vector information.\n\n\n\n\n\n","category":"function"},{"location":"manual/inputs/#Xtals.BondingRule","page":"Loading Data","title":"Xtals.BondingRule","text":"bonding_rule = BondingRule(:Ca, :O, 2.0)\nbonding_rules = [BondingRule(:H, :*, 1.2),\n                 BondingRule(:*, :*, 1.9)]\n\nA rule for determining if two atoms within a crystal are bonded.\n\nAttributes\n\nspecies_i::Symbol: One of the atoms types for this bond rule\nspecies_j::Symbol: The other atom type for this bond rule\nmax_dist: The maximum distance between the atoms for bonding to occur\n\n\n\n\n\n","category":"type"},{"location":"manual/inputs/#Xtals.strip_numbers_from_atom_labels!","page":"Loading Data","title":"Xtals.strip_numbers_from_atom_labels!","text":"strip_numbers_from_atom_labels!(crystal)\n\nStrip numbers from labels for crystal.atoms. Precisely, for atom in crystal.atoms, find the first number that appears in atom. Remove this number and all following characters from atom. e.g. C12 –> C \t Ba12A_3 –> Ba\n\nArguments\n\ncrystal::Crystal: The crystal containing the crystal structure information\n\n\n\n\n\n","category":"function"},{"location":"PoreMatModGO/#PoreMatModGO","page":"PoreMatModGO","title":"PoreMatModGO","text":"","category":"section"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"To make PoreMatMod.jl more accessible, an express graphical interface, PoreMatModGO, is provided.   The PoreMatModGO interface, built on Pluto.jl, enables interactive application of chemical substructure find/replace operations with minimal setup and no code provided by the user.","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"Follow the steps in Getting Started.","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"Then, add the required dependencies and launch Pluto.jl:","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"pkg> add Pluto, PlutoUI, Bio3DView\njulia> using Pluto\njulia> Pluto.run()","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"Pluto should launch in a new tab in your default web browser.","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"Load PoreMatModGO.jl by copying and pasting the URL below into the \"Open from file\" box on the Pluto main page.","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"https://raw.githubusercontent.com/SimonEnsemble/PoreMatMod.jl/master/src/PoreMatModGO.jl","category":"page"},{"location":"PoreMatModGO/","page":"PoreMatModGO","title":"PoreMatModGO","text":"Prepare file inputs per the manual and load them into PoreMatModGO using the graphical interface.   All replacement modes are available with interactive visual previews and outputs are downloadable in .cif, .xyz, and .vtk file formats.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"DocTestSetup = quote\n    using PoreMatMod\nend","category":"page"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"The Pluto notebooks (.jl) containing the Julia code and the input files for all examples are in the examples directory.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"Click on the images or descriptions below to see Pluto notebooks demonstrating each use case.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"example: Example: Generate hypothetical structures\nDecorate IRMOF-1 with a functional group: ortho substitution with an acetylamido group at one quarter of the p-phenylene moieties.link     (Image: example 1) ","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"example: Example: Using different replacement modes\nReplace BDC with nitro-BDC in IRMOF-1 using the different replacement modes to obtain different results.link     (Image: example1.5) ","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"example: Example: Insert missing hydrogen atoms\nInsert missing H atoms in IRMOF-1.link     (Image: example 2) ","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"example: Example: Repair Disorder and Remove Adsorbates\nCorrect the crystallographic disorder of the PyC-2 ligands and remove guest molecules from the pores of SIFSIX-Cu-2-i.link     (Image: example 3) ","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"example: Example: Generate Missing-Linker Defects\nCreate a new channel in UiO-66 by introducing missing-linker defects and formate ion capping.link     (Image: example 4) ","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"(Image: logo.JPG)","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"PoreMatMod.jl is a software package in Julia for (i) subgraph matching and (ii) modifying crystal structures. ","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"Functioning as a \"find-and-replace\" tool on atomistic structure models of porous materials, PoreMatMod.jl can:","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"search crystals for chemical substructures\ncreate libraries of hypothetical structures by e.g. decoration with functional groups\ncorrect artifacts of X-ray structure determination (missing H, disorder, guests)\nintroduce defects into crystal structures","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"PoreMatMod.jl implements ","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"(for find operations) Ullmann's algorithm for subgraph isomorphism search\n(for replace operations) the orthogonal Procrustes algorithm for point cloud alignment.  ","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"Periodic boundary conditions are respected, and the unit cell is preserved.","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"While developed primarily for porous crystals such as metal-organic frameworks (MOFs), PoreMatMod.jl can operate on any periodic atomistic system as well as discrete molecules.","category":"page"},{"location":"#introductory-example:-creating-a-functionalized-MOF-structure","page":"PoreMatMod","title":"introductory example: creating a functionalized MOF structure","text":"","category":"section"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"suppose we wish to decorate the linkers of IRMOF-1 with trifluoromethyl (tfm) groups. the PoreMatMod.jl code below accomplishes this by (i) searching the parent IRMOF-1 structure for a phenylene query fragment and (ii) replacing each instance with a tfm-phenylene replacement fragment to give the child structure.","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"# read crystal structure of the parent MOF\nparent_xtal = Crystal(\"IRMOF-1.cif\")\n\n# read query and replacement fragments\nquery_fragment       = moiety(\"p-phenylene.xyz\")  # masked atoms marked with !\nreplacement_fragment = moiety(\"tfm-p-phenylene.xyz\")\n\n# (1) search parent structure for query fragment\n# (2) replace occurrences of query fragment with replacement fragments\n#     (with randomly chosen orientations)\nchild_xtal = replace(parent_xtal, query_fragment => replacement_fragment)","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"(Image: )","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"example: Further examples\nSee the examples page for links to Pluto notebooks with PoreMatMod.jl code to accomplish various find-and-replace tasks.","category":"page"},{"location":"","page":"PoreMatMod","title":"PoreMatMod","text":"note: Please cite our paper!\nIf you found PoreMatMod.jl useful, please consider citing our paper:A. Henle, N. Gantzler, P. Thallapally, X. Fern, C. Simon. PoreMatMod.jl: Julia package for in silico post-synthetic modification of crystal structure models. ChemRxiv. (2021)","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"DocTestSetup = quote\n    using PoreMatMod\n    parent = Crystal(\"IRMOF-1.cif\")\n    infer_bonds!(parent, true)\n    query = moiety(\"p-phenylene.xyz\")\nend","category":"page"},{"location":"manual/find/#Subgraph-matching-(substructure-searches)","page":"Substructure Search","title":"Subgraph matching (substructure searches)","text":"","category":"section"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"(Image: find graphic)","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"PoreMatMod.jl conducts subgraph matching, i.e. searches for subgraphs of a parent graph isomorphic to a query graph, using Ullmann's algorithm for subgraph isomorphisms.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"During subgraph matching, both the parent crystal structure and query fragment are represented by node-labeled (by the chemical species) graphs. For crystals, bonds across the unit cell boundaries of periodic materials are accounted for, allowing us to find subgraph isomorphisms when the fragment is split across a unit cell boundary.","category":"page"},{"location":"manual/find/#Substructure-Searches:-how-to","page":"Substructure Search","title":"Substructure Searches: how to","text":"","category":"section"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"To learn by example, suppose we wish to search the IRMOF-1 crystal structure for p-phenylene fragments.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"First, we load the query fragment and parent structure:","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"parent = Crystal(\"IRMOF-1.cif\")\ninfer_bonds!(parent_xtal, true) # true to infer bonds across the periodic boundary\n\nquery = moiety(\"p-phenylene.xyz\")","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"With a parent and query loaded, execute a search:","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"search = substructure_search(query, parent)\n# output\np-phenylene.xyz ∈ IRMOF-1.cif\n96 hits in 24 locations.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"note: Syntactic sugar for substructure search\nThe ∈ (\\in then hit Tab for this Unicode character) infix operator will also execute the search:search = query ∈ parent","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Both functions substructure_search and ∈return aSearchobject which stores thequeryandparentstructures and the result of the search,isomorphisms`, a nested vector giving the query-to-parent correpondences.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"search.isomorphisms\n# output\n24-element Vector{Vector{Vector{Int64}}}:\n [[233, 306, 318, 245, 185, 197, 414, 329, 402, 341], [245, 318, 306, 233, 197, 185, 402, 341, 414, 329], [306, 233, 245, 318, 185, 197, 341, 402, 329, 414], [318, 245, 233, 306, 197, 185, 329, 414, 341, 402]]\n [[234, 305, 317, 246, 186, 198, 413, 330, 401, 342], [246, 317, 305, 234, 198, 186, 401, 342, 413, 330], [305, 234, 246, 317, 186, 198, 342, 401, 330, 413], [317, 246, 234, 305, 198, 186, 330, 413, 342, 401]]\n [[235, 308, 319, 248, 187, 200, 415, 331, 404, 344], [248, 319, 308, 235, 200, 187, 404, 344, 415, 331], [308, 235, 248, 319, 187, 200, 344, 404, 331, 415], [319, 248, 235, 308, 200, 187, 331, 415, 344, 404]]\n [[236, 307, 320, 247, 188, 199, 416, 332, 403, 343], [247, 320, 307, 236, 199, 188, 403, 343, 416, 332], [307, 236, 247, 320, 188, 199, 343, 403, 332, 416], [320, 247, 236, 307, 199, 188, 332, 416, 343, 403]]\n [[237, 262, 280, 255, 189, 207, 376, 333, 358, 351], [255, 280, 262, 237, 207, 189, 358, 351, 376, 333], [262, 237, 255, 280, 189, 207, 351, 358, 333, 376], [280, 255, 237, 262, 207, 189, 333, 376, 351, 358]]\n [[238, 261, 279, 256, 190, 208, 375, 334, 357, 352], [256, 279, 261, 238, 208, 190, 357, 352, 375, 334], [261, 238, 256, 279, 190, 208, 352, 357, 334, 375], [279, 256, 238, 261, 208, 190, 334, 375, 352, 357]]\n [[239, 264, 277, 254, 191, 206, 373, 335, 360, 350], [254, 277, 264, 239, 206, 191, 360, 350, 373, 335], [264, 239, 254, 277, 191, 206, 350, 360, 335, 373], [277, 254, 239, 264, 206, 191, 335, 373, 350, 360]]\n [[240, 263, 278, 253, 192, 205, 374, 336, 359, 349], [253, 278, 263, 240, 205, 192, 359, 349, 374, 336], [263, 240, 253, 278, 192, 205, 349, 359, 336, 374], [278, 253, 240, 263, 205, 192, 336, 374, 349, 359]]\n [[241, 290, 299, 252, 193, 204, 395, 337, 386, 348], [252, 299, 290, 241, 204, 193, 386, 348, 395, 337], [290, 241, 252, 299, 193, 204, 348, 386, 337, 395], [299, 252, 241, 290, 204, 193, 337, 395, 348, 386]]\n [[242, 289, 300, 251, 194, 203, 396, 338, 385, 347], [251, 300, 289, 242, 203, 194, 385, 347, 396, 338], [289, 242, 251, 300, 194, 203, 347, 385, 338, 396], [300, 251, 242, 289, 203, 194, 338, 396, 347, 385]]\n ⋮\n [[260, 283, 296, 271, 212, 219, 392, 356, 379, 367], [271, 296, 283, 260, 219, 212, 379, 367, 392, 356], [283, 260, 271, 296, 212, 219, 367, 379, 356, 392], [296, 271, 260, 283, 219, 212, 356, 392, 367, 379]]\n [[265, 314, 323, 276, 213, 224, 419, 361, 410, 372], [276, 323, 314, 265, 224, 213, 410, 372, 419, 361], [314, 265, 276, 323, 213, 224, 372, 410, 361, 419], [323, 276, 265, 314, 224, 213, 361, 419, 372, 410]]\n [[266, 313, 324, 275, 214, 223, 420, 362, 409, 371], [275, 324, 313, 266, 223, 214, 409, 371, 420, 362], [313, 266, 275, 324, 214, 223, 371, 409, 362, 420], [324, 275, 266, 313, 223, 214, 362, 420, 371, 409]]\n [[267, 316, 322, 273, 215, 221, 418, 363, 412, 369], [273, 322, 316, 267, 221, 215, 412, 369, 418, 363], [316, 267, 273, 322, 215, 221, 369, 412, 363, 418], [322, 273, 267, 316, 221, 215, 363, 418, 369, 412]]\n [[268, 315, 321, 274, 216, 222, 417, 364, 411, 370], [274, 321, 315, 268, 222, 216, 411, 370, 417, 364], [315, 268, 274, 321, 216, 222, 370, 411, 364, 417], [321, 274, 268, 315, 222, 216, 364, 417, 370, 411]]\n [[285, 310, 328, 303, 225, 231, 424, 381, 406, 399], [303, 328, 310, 285, 231, 225, 406, 399, 424, 381], [310, 285, 303, 328, 225, 231, 399, 406, 381, 424], [328, 303, 285, 310, 231, 225, 381, 424, 399, 406]]\n [[286, 309, 327, 304, 226, 232, 423, 382, 405, 400], [304, 327, 309, 286, 232, 226, 405, 400, 423, 382], [309, 286, 304, 327, 226, 232, 400, 405, 382, 423], [327, 304, 286, 309, 232, 226, 382, 423, 400, 405]]\n [[287, 312, 325, 302, 227, 230, 421, 383, 408, 398], [302, 325, 312, 287, 230, 227, 408, 398, 421, 383], [312, 287, 302, 325, 227, 230, 398, 408, 383, 421], [325, 302, 287, 312, 230, 227, 383, 421, 398, 408]]\n [[288, 311, 326, 301, 228, 229, 422, 384, 407, 397], [301, 326, 311, 288, 229, 228, 407, 397, 422, 384], [311, 288, 301, 326, 228, 229, 397, 407, 384, 422], [326, 301, 288, 311, 229, 228, 384, 422, 397, 407]]","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"In this example, the query fragment (p-phenylene) occurs in 24 different location in the parent crystal structure, with 4 symmetry-equivalent isomorphisms at each location, for a total of 96 subgraph isomorphisms.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"The number of locations–-the number of unique substructures of the parent to which the query is isomorphic–-is the length of search.isomorphisms","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"nb_locations(search) # = length(search.isomorphisms)\n# output\n24","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Element i_loc of search.isomorphisms, search.isomorphisms[i_loc], is a vector of isomorphisms that share the same subset of atoms in the parent, each of which correspond to a different orientation of the query overlaying that parent substructure. The function nb_ori_at_loc outputs a vector whose element i_loc is the number of overlay orientations at that location.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"nb_ori_at_loc(search)  # 24-element Vector{Int64}: [4, 4, 4, ..., 4]","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"The individual isomorphisms isom = search.isomorphisms[i_loc][i_ori] for a specific location i_loc and orientation i_ori indicate the correspondence from the query to the parent struture. If atom q of the query maps to atom p of the parent, then isom[q] == p.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"The total number of isomorphisms is given by nb_isomorphisms(search).","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"nb_isomorphisms(search) # = sum(nb_ori_at_loc(search))\n# output\n96","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"N.b. to generate a Crystal containing only the substructures of the parent which are isomorphic to the query, use:","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"isomorphic_substructures(search)\n# output\nName: IRMOF-1.cif\nBravais unit cell of a crystal.\n\tUnit cell angles α = 90.000000 deg. β = 90.000000 deg. γ = 90.000000 deg.\n\tUnit cell dimensions a = 25.832000 Å. b = 25.832000 Å, c = 25.832000 Å\n\tVolume of unit cell: 17237.492730 Å³\n\n\t# atoms = 240\n\t# charges = 0\n\tchemical formula: Dict(:H => 2, :C => 3)\n\tspace Group: P1\n\tsymmetry Operations:\n\t\t'x, y, z'","category":"page"},{"location":"manual/find/#Stereochemistry-and-Isomorphism","page":"Substructure Search","title":"Stereochemistry and Isomorphism","text":"","category":"section"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"An undirected labeled graph representation of a bonding network is invariant with respect to stereochemistry. In other words, every rotational/conformational state and stereoisomer of a structure shares the same graph representation. What this means is that PoreMatMod.jl may find more subgraph matches than you first expect. ","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"(Image: symmetry viz)","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"The p-phenylene case (above) shows us how 4-fold symmetry in the point cloud representation (mirror planes shown at left) translates to multiple isomorphisms for a single occurence of the fragment in a structure. The isomorphisms in this case all represent different orientations of the fragment (hydrogen labels shown at right).","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Example 2: searching for BDC.xyz query in IRMOF-1 parent instead of the more minimal p-phenylene fragment. Thanks to the two carboxyl groups, the total number of isomorphisms is multiplied by a factor of 4, due to the graph-equivalence of the oxygen atoms in each group.   The number of locations at which the isomorphisms are found, however, is unchanged.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"query = moiety(\"BDC.xyz\")\nsearch = query ∈ parent\nnb_isomorphisms(search) \n# output\n384","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"nb_locations(search) \n# output\n24","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Example 3: searching for CH_3 in C_2H_6 yields not two matches, but twelve matches because there are six mappings between the graph of CH_3 and each methyl group of the ethane molecule that satisfy the subgraph isomorphism problem.  Why six?  There are three rotational states and a plane of symmetry.","category":"page"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Note: We advise to define the query using the most minimal structure that matches the targeted parent substructure.","category":"page"},{"location":"manual/find/#Documentation-for-functions","page":"Substructure Search","title":"Documentation for functions","text":"","category":"section"},{"location":"manual/find/","page":"Substructure Search","title":"Substructure Search","text":"Search\nsubstructure_search\nnb_ori_at_loc\nnb_isomorphisms\nnb_locations\nisomorphic_substructures","category":"page"},{"location":"manual/find/#PoreMatMod.Search","page":"Substructure Search","title":"PoreMatMod.Search","text":"search = Search(parent, query, results)\n\nStores the parent and query used for a substructure search and the results (isomorphisms) of the subgraph matching algorithm.\n\nattributes\n\nsearch.parent::Crystal                           # the parent in the search\nsearch.query::Crystal                            # the query in the search\nsearch.isomorphisms::Vector{Vector{Vector{Int}}} # the query-to-parent correspondences\n\nThe isomorphisms are grouped by location in the parent Crystal and can be examined using nb_isomorphisms, nb_locations, and nb_ori_at_loc.\n\nSubgraph isomorphisms are encoded like\n\n`isom = search.isomorphisms[i_loc][i_ori] = [7, 21, 9]`\n\nwhere isom[k] is the index of the atom in search.parent corresponding to atom k in search.query for the isomorphism at location i_loc and orientation i_ori.\n\n\n\n\n\n","category":"type"},{"location":"manual/find/#PoreMatMod.substructure_search","page":"Substructure Search","title":"PoreMatMod.substructure_search","text":"```julia\nsubstructure_search(query, parent; disconnected_component=false)\n```\n\nSearches for a substructure within a Crystal and returns a Search struct containing all identified subgraph isomorphisms.  Matches are made on the basis of atomic species and chemical bonding networks, including bonds across unit cell periodic boundaries.  The search moiety may optionally contain markup for designating atoms to replace with other moieties.\n\nArguments\n\nquery::Crystal the search moiety\nparent::Crystal the parent structure\ndisconnected_component::Bool=false if true, disables substructure searching (e.g. for finding guest molecules)\n\n\n\n\n\n","category":"function"},{"location":"manual/find/#PoreMatMod.nb_ori_at_loc","page":"Substructure Search","title":"PoreMatMod.nb_ori_at_loc","text":"```julia\nnb_ori_at_loc(search)\n```\n\nReturns a array containing the number of isomorphic configurations at a given location (collection of atoms) for which the specified Search results contain isomorphisms.\n\nArguments\n\nsearch::Search a substructure Search object\n\n\n\n\n\n","category":"function"},{"location":"manual/find/#PoreMatMod.nb_isomorphisms","page":"Substructure Search","title":"PoreMatMod.nb_isomorphisms","text":"```julia\nnb_isomorphisms(search::Search)\n```\n\nReturns the number of isomorphisms found in the specified Search\n\nArguments\n\nsearch::Search a substructure Search object\n\n\n\n\n\n","category":"function"},{"location":"manual/find/#PoreMatMod.nb_locations","page":"Substructure Search","title":"PoreMatMod.nb_locations","text":"```julia\nnb_locations(search::Search)\n```\n\nReturns the number of unique locations in the parent (sets of atoms in the parent) at which the specified Search results contain isomorphisms.\n\nArguments\n\nsearch::Search a substructure Search object\n\n\n\n\n\n","category":"function"},{"location":"manual/find/#PoreMatMod.isomorphic_substructures","page":"Substructure Search","title":"PoreMatMod.isomorphic_substructures","text":"```julia\niso_structs = isomorphic_substructures(s::Search)::Crystal\n```\n\nReturns a crystal consisting of the atoms of the parent involved in subgraph isomorphisms in the search s\n\n\n\n\n\n","category":"function"}]
}
