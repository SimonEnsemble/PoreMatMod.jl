<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Substructure Search · PoreMatMod.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><script src="../../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.jpg" alt="PoreMatMod.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PoreMatMod.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">PoreMatMod</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../start/">Getting Started</a></li><li><a class="tocitem" href="../inputs/">Loading Data</a></li><li class="is-active"><a class="tocitem" href>Substructure Search</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Substructure-Searches:-how-to"><span>Substructure Searches: how to</span></a></li><li><a class="tocitem" href="#Stereochemistry-and-Isomorphism"><span>Stereochemistry and Isomorphism</span></a></li><li><a class="tocitem" href="#Documentation-for-functions"><span>Documentation for functions</span></a></li></ul></li><li><a class="tocitem" href="../replace/">Substructure Find/Replace</a></li></ul></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../PoreMatModGO/">PoreMatModGO</a></li><li><a class="tocitem" href="../../collab/">Contribute/Report Issues</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Substructure Search</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Substructure Search</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/master/docs/src/manual/find.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Subgraph-matching-(substructure-searches)"><a class="docs-heading-anchor" href="#Subgraph-matching-(substructure-searches)">Subgraph matching (substructure searches)</a><a id="Subgraph-matching-(substructure-searches)-1"></a><a class="docs-heading-anchor-permalink" href="#Subgraph-matching-(substructure-searches)" title="Permalink"></a></h1><p><code>PoreMatMod.jl</code> conducts subgraph matching, i.e. searches for subgraphs of a <code>parent</code> graph isomorphic to a <code>query</code> graph, using <a href="https://doi.org/10.1145/321921.321925">Ullmann&#39;s algorithm for subgraph isomorphisms</a>.</p><p>For subgraph matching, both the <code>parent</code> crystal structure and <code>query</code> fragment are represented by node-labeled (by the chemical species) graphs (nodes = atoms, edges = bonds). For crystals, bonds across the unit cell boundaries of periodic materials are accounted for, allowing us to find subgraph isomorphisms when the fragment is split across a unit cell boundary.</p><h1 id="Substructure-Searches:-how-to"><a class="docs-heading-anchor" href="#Substructure-Searches:-how-to">Substructure Searches: how to</a><a id="Substructure-Searches:-how-to-1"></a><a class="docs-heading-anchor-permalink" href="#Substructure-Searches:-how-to" title="Permalink"></a></h1><p>To learn by example, suppose we wish to search the IRMOF-1 crystal structure for <em>p</em>-phenylene fragments.</p><p><img src="../../assets/find/s_moty-in-xtal.png" alt="find graphic"/></p><p>First, we load the <code>query</code> fragment and <code>parent</code> crystal structure:</p><pre><code class="language-julia hljs">parent = Crystal(&quot;IRMOF-1.cif&quot;)
infer_bonds!(parent_xtal, true) # true to infer bonds across the periodic boundary

query = moiety(&quot;p-phenylene.xyz&quot;)</code></pre><p>then execute a search for subgraphs of the <code>parent</code> that &quot;match&quot; (are isomorphic to) the graph of the <code>query</code> fragment:</p><pre><code class="language-julia hljs">search = substructure_search(query, parent)
# output
p-phenylene.xyz ∈ IRMOF-1.cif
96 hits in 24 locations.</code></pre><div class="admonition is-info"><header class="admonition-header">Syntactic sugar for substructure search</header><div class="admonition-body"><p>The <code>∈</code> (<code>\in</code> then hit <code>Tab</code> for this Unicode character) or <code>in</code> infix operators will also execute the search:</p><pre><code class="language-julia hljs">search = query ∈ parent
# or
search = query in parent
# or
search = substructure_search(query, parent)</code></pre></div></div><p>Both functions <code>substructure_search</code> and <code>∈</code> return a <code>Search</code> object with attributes:</p><ul><li><code>search.query</code>: the query in the search</li><li><code>search.parent</code>: the parent in the search</li><li><code>search.isomorphisms</code>: the result of a search–-a nested vector giving the query-to-parent correpondence dictionaries.</li></ul><pre><code class="language-julia hljs">search.isomorphisms
# output
24-element Vector{Vector{Dict{Int64, Int64}}}:
 [Dict(5 =&gt; 185, 4 =&gt; 245, 6 =&gt; 197, 7 =&gt; 414, 2 =&gt; 306, 10 =&gt; 341, 9 =&gt; 402, 8 =&gt; 329, 3 =&gt; 318, 1 =&gt; 233…), Dict(5 =&gt; 197, 4 =&gt; 233, 6 =&gt; 185, 7 =&gt; 402, 2 =&gt; 318, 10 =&gt; 329, 9 =&gt; 414, 8 =&gt; 341, 3 =&gt; 306, 1 =&gt; 245…), Dict(5 =&gt; 185, 4 =&gt; 318, 6 =&gt; 197, 7 =&gt; 341, 2 =&gt; 233, 10 =&gt; 414, 9 =&gt; 329, 8 =&gt; 402, 3 =&gt; 245, 1 =&gt; 306…), Dict(5 =&gt; 197, 4 =&gt; 306, 6 =&gt; 185, 7 =&gt; 329, 2 =&gt; 245, 10 =&gt; 402, 9 =&gt; 341, 8 =&gt; 414, 3 =&gt; 233, 1 =&gt; 318…)]
 [Dict(5 =&gt; 186, 4 =&gt; 246, 6 =&gt; 198, 7 =&gt; 413, 2 =&gt; 305, 10 =&gt; 342, 9 =&gt; 401, 8 =&gt; 330, 3 =&gt; 317, 1 =&gt; 234…), Dict(5 =&gt; 198, 4 =&gt; 234, 6 =&gt; 186, 7 =&gt; 401, 2 =&gt; 317, 10 =&gt; 330, 9 =&gt; 413, 8 =&gt; 342, 3 =&gt; 305, 1 =&gt; 246…), Dict(5 =&gt; 186, 4 =&gt; 317, 6 =&gt; 198, 7 =&gt; 342, 2 =&gt; 234, 10 =&gt; 413, 9 =&gt; 330, 8 =&gt; 401, 3 =&gt; 246, 1 =&gt; 305…), Dict(5 =&gt; 198, 4 =&gt; 305, 6 =&gt; 186, 7 =&gt; 330, 2 =&gt; 246, 10 =&gt; 401, 9 =&gt; 342, 8 =&gt; 413, 3 =&gt; 234, 1 =&gt; 317…)]
 [Dict(5 =&gt; 187, 4 =&gt; 248, 6 =&gt; 200, 7 =&gt; 415, 2 =&gt; 308, 10 =&gt; 344, 9 =&gt; 404, 8 =&gt; 331, 3 =&gt; 319, 1 =&gt; 235…), Dict(5 =&gt; 200, 4 =&gt; 235, 6 =&gt; 187, 7 =&gt; 404, 2 =&gt; 319, 10 =&gt; 331, 9 =&gt; 415, 8 =&gt; 344, 3 =&gt; 308, 1 =&gt; 248…), Dict(5 =&gt; 187, 4 =&gt; 319, 6 =&gt; 200, 7 =&gt; 344, 2 =&gt; 235, 10 =&gt; 415, 9 =&gt; 331, 8 =&gt; 404, 3 =&gt; 248, 1 =&gt; 308…), Dict(5 =&gt; 200, 4 =&gt; 308, 6 =&gt; 187, 7 =&gt; 331, 2 =&gt; 248, 10 =&gt; 404, 9 =&gt; 344, 8 =&gt; 415, 3 =&gt; 235, 1 =&gt; 319…)]
 [Dict(5 =&gt; 188, 4 =&gt; 247, 6 =&gt; 199, 7 =&gt; 416, 2 =&gt; 307, 10 =&gt; 343, 9 =&gt; 403, 8 =&gt; 332, 3 =&gt; 320, 1 =&gt; 236…), Dict(5 =&gt; 199, 4 =&gt; 236, 6 =&gt; 188, 7 =&gt; 403, 2 =&gt; 320, 10 =&gt; 332, 9 =&gt; 416, 8 =&gt; 343, 3 =&gt; 307, 1 =&gt; 247…), Dict(5 =&gt; 188, 4 =&gt; 320, 6 =&gt; 199, 7 =&gt; 343, 2 =&gt; 236, 10 =&gt; 416, 9 =&gt; 332, 8 =&gt; 403, 3 =&gt; 247, 1 =&gt; 307…), Dict(5 =&gt; 199, 4 =&gt; 307, 6 =&gt; 188, 7 =&gt; 332, 2 =&gt; 247, 10 =&gt; 403, 9 =&gt; 343, 8 =&gt; 416, 3 =&gt; 236, 1 =&gt; 320…)]
 [Dict(5 =&gt; 189, 4 =&gt; 255, 6 =&gt; 207, 7 =&gt; 376, 2 =&gt; 262, 10 =&gt; 351, 9 =&gt; 358, 8 =&gt; 333, 3 =&gt; 280, 1 =&gt; 237…), Dict(5 =&gt; 207, 4 =&gt; 237, 6 =&gt; 189, 7 =&gt; 358, 2 =&gt; 280, 10 =&gt; 333, 9 =&gt; 376, 8 =&gt; 351, 3 =&gt; 262, 1 =&gt; 255…), Dict(5 =&gt; 189, 4 =&gt; 280, 6 =&gt; 207, 7 =&gt; 351, 2 =&gt; 237, 10 =&gt; 376, 9 =&gt; 333, 8 =&gt; 358, 3 =&gt; 255, 1 =&gt; 262…), Dict(5 =&gt; 207, 4 =&gt; 262, 6 =&gt; 189, 7 =&gt; 333, 2 =&gt; 255, 10 =&gt; 358, 9 =&gt; 351, 8 =&gt; 376, 3 =&gt; 237, 1 =&gt; 280…)]
 [Dict(5 =&gt; 190, 4 =&gt; 256, 6 =&gt; 208, 7 =&gt; 375, 2 =&gt; 261, 10 =&gt; 352, 9 =&gt; 357, 8 =&gt; 334, 3 =&gt; 279, 1 =&gt; 238…), Dict(5 =&gt; 208, 4 =&gt; 238, 6 =&gt; 190, 7 =&gt; 357, 2 =&gt; 279, 10 =&gt; 334, 9 =&gt; 375, 8 =&gt; 352, 3 =&gt; 261, 1 =&gt; 256…), Dict(5 =&gt; 190, 4 =&gt; 279, 6 =&gt; 208, 7 =&gt; 352, 2 =&gt; 238, 10 =&gt; 375, 9 =&gt; 334, 8 =&gt; 357, 3 =&gt; 256, 1 =&gt; 261…), Dict(5 =&gt; 208, 4 =&gt; 261, 6 =&gt; 190, 7 =&gt; 334, 2 =&gt; 256, 10 =&gt; 357, 9 =&gt; 352, 8 =&gt; 375, 3 =&gt; 238, 1 =&gt; 279…)]
 [Dict(5 =&gt; 191, 4 =&gt; 254, 6 =&gt; 206, 7 =&gt; 373, 2 =&gt; 264, 10 =&gt; 350, 9 =&gt; 360, 8 =&gt; 335, 3 =&gt; 277, 1 =&gt; 239…), Dict(5 =&gt; 206, 4 =&gt; 239, 6 =&gt; 191, 7 =&gt; 360, 2 =&gt; 277, 10 =&gt; 335, 9 =&gt; 373, 8 =&gt; 350, 3 =&gt; 264, 1 =&gt; 254…), Dict(5 =&gt; 191, 4 =&gt; 277, 6 =&gt; 206, 7 =&gt; 350, 2 =&gt; 239, 10 =&gt; 373, 9 =&gt; 335, 8 =&gt; 360, 3 =&gt; 254, 1 =&gt; 264…), Dict(5 =&gt; 206, 4 =&gt; 264, 6 =&gt; 191, 7 =&gt; 335, 2 =&gt; 254, 10 =&gt; 360, 9 =&gt; 350, 8 =&gt; 373, 3 =&gt; 239, 1 =&gt; 277…)]
 [Dict(5 =&gt; 192, 4 =&gt; 253, 6 =&gt; 205, 7 =&gt; 374, 2 =&gt; 263, 10 =&gt; 349, 9 =&gt; 359, 8 =&gt; 336, 3 =&gt; 278, 1 =&gt; 240…), Dict(5 =&gt; 205, 4 =&gt; 240, 6 =&gt; 192, 7 =&gt; 359, 2 =&gt; 278, 10 =&gt; 336, 9 =&gt; 374, 8 =&gt; 349, 3 =&gt; 263, 1 =&gt; 253…), Dict(5 =&gt; 192, 4 =&gt; 278, 6 =&gt; 205, 7 =&gt; 349, 2 =&gt; 240, 10 =&gt; 374, 9 =&gt; 336, 8 =&gt; 359, 3 =&gt; 253, 1 =&gt; 263…), Dict(5 =&gt; 205, 4 =&gt; 263, 6 =&gt; 192, 7 =&gt; 336, 2 =&gt; 253, 10 =&gt; 359, 9 =&gt; 349, 8 =&gt; 374, 3 =&gt; 240, 1 =&gt; 278…)]
 [Dict(5 =&gt; 193, 4 =&gt; 252, 6 =&gt; 204, 7 =&gt; 395, 2 =&gt; 290, 10 =&gt; 348, 9 =&gt; 386, 8 =&gt; 337, 3 =&gt; 299, 1 =&gt; 241…), Dict(5 =&gt; 204, 4 =&gt; 241, 6 =&gt; 193, 7 =&gt; 386, 2 =&gt; 299, 10 =&gt; 337, 9 =&gt; 395, 8 =&gt; 348, 3 =&gt; 290, 1 =&gt; 252…), Dict(5 =&gt; 193, 4 =&gt; 299, 6 =&gt; 204, 7 =&gt; 348, 2 =&gt; 241, 10 =&gt; 395, 9 =&gt; 337, 8 =&gt; 386, 3 =&gt; 252, 1 =&gt; 290…), Dict(5 =&gt; 204, 4 =&gt; 290, 6 =&gt; 193, 7 =&gt; 337, 2 =&gt; 252, 10 =&gt; 386, 9 =&gt; 348, 8 =&gt; 395, 3 =&gt; 241, 1 =&gt; 299…)]
 [Dict(5 =&gt; 194, 4 =&gt; 251, 6 =&gt; 203, 7 =&gt; 396, 2 =&gt; 289, 10 =&gt; 347, 9 =&gt; 385, 8 =&gt; 338, 3 =&gt; 300, 1 =&gt; 242…), Dict(5 =&gt; 203, 4 =&gt; 242, 6 =&gt; 194, 7 =&gt; 385, 2 =&gt; 300, 10 =&gt; 338, 9 =&gt; 396, 8 =&gt; 347, 3 =&gt; 289, 1 =&gt; 251…), Dict(5 =&gt; 194, 4 =&gt; 300, 6 =&gt; 203, 7 =&gt; 347, 2 =&gt; 242, 10 =&gt; 396, 9 =&gt; 338, 8 =&gt; 385, 3 =&gt; 251, 1 =&gt; 289…), Dict(5 =&gt; 203, 4 =&gt; 289, 6 =&gt; 194, 7 =&gt; 338, 2 =&gt; 251, 10 =&gt; 385, 9 =&gt; 347, 8 =&gt; 396, 3 =&gt; 242, 1 =&gt; 300…)]
 ⋮
 [Dict(5 =&gt; 212, 4 =&gt; 271, 6 =&gt; 219, 7 =&gt; 392, 2 =&gt; 283, 10 =&gt; 367, 9 =&gt; 379, 8 =&gt; 356, 3 =&gt; 296, 1 =&gt; 260…), Dict(5 =&gt; 219, 4 =&gt; 260, 6 =&gt; 212, 7 =&gt; 379, 2 =&gt; 296, 10 =&gt; 356, 9 =&gt; 392, 8 =&gt; 367, 3 =&gt; 283, 1 =&gt; 271…), Dict(5 =&gt; 212, 4 =&gt; 296, 6 =&gt; 219, 7 =&gt; 367, 2 =&gt; 260, 10 =&gt; 392, 9 =&gt; 356, 8 =&gt; 379, 3 =&gt; 271, 1 =&gt; 283…), Dict(5 =&gt; 219, 4 =&gt; 283, 6 =&gt; 212, 7 =&gt; 356, 2 =&gt; 271, 10 =&gt; 379, 9 =&gt; 367, 8 =&gt; 392, 3 =&gt; 260, 1 =&gt; 296…)]
 [Dict(5 =&gt; 213, 4 =&gt; 276, 6 =&gt; 224, 7 =&gt; 419, 2 =&gt; 314, 10 =&gt; 372, 9 =&gt; 410, 8 =&gt; 361, 3 =&gt; 323, 1 =&gt; 265…), Dict(5 =&gt; 224, 4 =&gt; 265, 6 =&gt; 213, 7 =&gt; 410, 2 =&gt; 323, 10 =&gt; 361, 9 =&gt; 419, 8 =&gt; 372, 3 =&gt; 314, 1 =&gt; 276…), Dict(5 =&gt; 213, 4 =&gt; 323, 6 =&gt; 224, 7 =&gt; 372, 2 =&gt; 265, 10 =&gt; 419, 9 =&gt; 361, 8 =&gt; 410, 3 =&gt; 276, 1 =&gt; 314…), Dict(5 =&gt; 224, 4 =&gt; 314, 6 =&gt; 213, 7 =&gt; 361, 2 =&gt; 276, 10 =&gt; 410, 9 =&gt; 372, 8 =&gt; 419, 3 =&gt; 265, 1 =&gt; 323…)]
 [Dict(5 =&gt; 214, 4 =&gt; 275, 6 =&gt; 223, 7 =&gt; 420, 2 =&gt; 313, 10 =&gt; 371, 9 =&gt; 409, 8 =&gt; 362, 3 =&gt; 324, 1 =&gt; 266…), Dict(5 =&gt; 223, 4 =&gt; 266, 6 =&gt; 214, 7 =&gt; 409, 2 =&gt; 324, 10 =&gt; 362, 9 =&gt; 420, 8 =&gt; 371, 3 =&gt; 313, 1 =&gt; 275…), Dict(5 =&gt; 214, 4 =&gt; 324, 6 =&gt; 223, 7 =&gt; 371, 2 =&gt; 266, 10 =&gt; 420, 9 =&gt; 362, 8 =&gt; 409, 3 =&gt; 275, 1 =&gt; 313…), Dict(5 =&gt; 223, 4 =&gt; 313, 6 =&gt; 214, 7 =&gt; 362, 2 =&gt; 275, 10 =&gt; 409, 9 =&gt; 371, 8 =&gt; 420, 3 =&gt; 266, 1 =&gt; 324…)]
 [Dict(5 =&gt; 215, 4 =&gt; 273, 6 =&gt; 221, 7 =&gt; 418, 2 =&gt; 316, 10 =&gt; 369, 9 =&gt; 412, 8 =&gt; 363, 3 =&gt; 322, 1 =&gt; 267…), Dict(5 =&gt; 221, 4 =&gt; 267, 6 =&gt; 215, 7 =&gt; 412, 2 =&gt; 322, 10 =&gt; 363, 9 =&gt; 418, 8 =&gt; 369, 3 =&gt; 316, 1 =&gt; 273…), Dict(5 =&gt; 215, 4 =&gt; 322, 6 =&gt; 221, 7 =&gt; 369, 2 =&gt; 267, 10 =&gt; 418, 9 =&gt; 363, 8 =&gt; 412, 3 =&gt; 273, 1 =&gt; 316…), Dict(5 =&gt; 221, 4 =&gt; 316, 6 =&gt; 215, 7 =&gt; 363, 2 =&gt; 273, 10 =&gt; 412, 9 =&gt; 369, 8 =&gt; 418, 3 =&gt; 267, 1 =&gt; 322…)]
 [Dict(5 =&gt; 216, 4 =&gt; 274, 6 =&gt; 222, 7 =&gt; 417, 2 =&gt; 315, 10 =&gt; 370, 9 =&gt; 411, 8 =&gt; 364, 3 =&gt; 321, 1 =&gt; 268…), Dict(5 =&gt; 222, 4 =&gt; 268, 6 =&gt; 216, 7 =&gt; 411, 2 =&gt; 321, 10 =&gt; 364, 9 =&gt; 417, 8 =&gt; 370, 3 =&gt; 315, 1 =&gt; 274…), Dict(5 =&gt; 216, 4 =&gt; 321, 6 =&gt; 222, 7 =&gt; 370, 2 =&gt; 268, 10 =&gt; 417, 9 =&gt; 364, 8 =&gt; 411, 3 =&gt; 274, 1 =&gt; 315…), Dict(5 =&gt; 222, 4 =&gt; 315, 6 =&gt; 216, 7 =&gt; 364, 2 =&gt; 274, 10 =&gt; 411, 9 =&gt; 370, 8 =&gt; 417, 3 =&gt; 268, 1 =&gt; 321…)]
 [Dict(5 =&gt; 225, 4 =&gt; 303, 6 =&gt; 231, 7 =&gt; 424, 2 =&gt; 310, 10 =&gt; 399, 9 =&gt; 406, 8 =&gt; 381, 3 =&gt; 328, 1 =&gt; 285…), Dict(5 =&gt; 231, 4 =&gt; 285, 6 =&gt; 225, 7 =&gt; 406, 2 =&gt; 328, 10 =&gt; 381, 9 =&gt; 424, 8 =&gt; 399, 3 =&gt; 310, 1 =&gt; 303…), Dict(5 =&gt; 225, 4 =&gt; 328, 6 =&gt; 231, 7 =&gt; 399, 2 =&gt; 285, 10 =&gt; 424, 9 =&gt; 381, 8 =&gt; 406, 3 =&gt; 303, 1 =&gt; 310…), Dict(5 =&gt; 231, 4 =&gt; 310, 6 =&gt; 225, 7 =&gt; 381, 2 =&gt; 303, 10 =&gt; 406, 9 =&gt; 399, 8 =&gt; 424, 3 =&gt; 285, 1 =&gt; 328…)]
 [Dict(5 =&gt; 226, 4 =&gt; 304, 6 =&gt; 232, 7 =&gt; 423, 2 =&gt; 309, 10 =&gt; 400, 9 =&gt; 405, 8 =&gt; 382, 3 =&gt; 327, 1 =&gt; 286…), Dict(5 =&gt; 232, 4 =&gt; 286, 6 =&gt; 226, 7 =&gt; 405, 2 =&gt; 327, 10 =&gt; 382, 9 =&gt; 423, 8 =&gt; 400, 3 =&gt; 309, 1 =&gt; 304…), Dict(5 =&gt; 226, 4 =&gt; 327, 6 =&gt; 232, 7 =&gt; 400, 2 =&gt; 286, 10 =&gt; 423, 9 =&gt; 382, 8 =&gt; 405, 3 =&gt; 304, 1 =&gt; 309…), Dict(5 =&gt; 232, 4 =&gt; 309, 6 =&gt; 226, 7 =&gt; 382, 2 =&gt; 304, 10 =&gt; 405, 9 =&gt; 400, 8 =&gt; 423, 3 =&gt; 286, 1 =&gt; 327…)]
 [Dict(5 =&gt; 227, 4 =&gt; 302, 6 =&gt; 230, 7 =&gt; 421, 2 =&gt; 312, 10 =&gt; 398, 9 =&gt; 408, 8 =&gt; 383, 3 =&gt; 325, 1 =&gt; 287…), Dict(5 =&gt; 230, 4 =&gt; 287, 6 =&gt; 227, 7 =&gt; 408, 2 =&gt; 325, 10 =&gt; 383, 9 =&gt; 421, 8 =&gt; 398, 3 =&gt; 312, 1 =&gt; 302…), Dict(5 =&gt; 227, 4 =&gt; 325, 6 =&gt; 230, 7 =&gt; 398, 2 =&gt; 287, 10 =&gt; 421, 9 =&gt; 383, 8 =&gt; 408, 3 =&gt; 302, 1 =&gt; 312…), Dict(5 =&gt; 230, 4 =&gt; 312, 6 =&gt; 227, 7 =&gt; 383, 2 =&gt; 302, 10 =&gt; 408, 9 =&gt; 398, 8 =&gt; 421, 3 =&gt; 287, 1 =&gt; 325…)]
 [Dict(5 =&gt; 228, 4 =&gt; 301, 6 =&gt; 229, 7 =&gt; 422, 2 =&gt; 311, 10 =&gt; 397, 9 =&gt; 407, 8 =&gt; 384, 3 =&gt; 326, 1 =&gt; 288…), Dict(5 =&gt; 229, 4 =&gt; 288, 6 =&gt; 228, 7 =&gt; 407, 2 =&gt; 326, 10 =&gt; 384, 9 =&gt; 422, 8 =&gt; 397, 3 =&gt; 311, 1 =&gt; 301…), Dict(5 =&gt; 228, 4 =&gt; 326, 6 =&gt; 229, 7 =&gt; 397, 2 =&gt; 288, 10 =&gt; 422, 9 =&gt; 384, 8 =&gt; 407, 3 =&gt; 301, 1 =&gt; 311…), Dict(5 =&gt; 229, 4 =&gt; 311, 6 =&gt; 228, 7 =&gt; 384, 2 =&gt; 301, 10 =&gt; 407, 9 =&gt; 397, 8 =&gt; 422, 3 =&gt; 288, 1 =&gt; 326…)]</code></pre><p>In this example, the <code>query</code> fragment (<em>p</em>-phenylene) occurs in 24 different location in the <code>parent</code> crystal structure, with 4 symmetry-equivalent isomorphisms at each location, for a total of 96 subgraph isomorphisms.</p><p>The number of locations–-the number of unique substructures of the <code>parent</code> to which the <code>query</code> is isomorphic–-is the length of <code>search.isomorphisms</code>.</p><pre><code class="language-julia hljs">nb_locations(search) # = length(search.isomorphisms)
# output
24</code></pre><p>Element <code>i_loc</code> of <code>search.isomorphisms</code>, <code>search.isomorphisms[i_loc]</code>, is a vector of isomorphisms that share the same subset of atoms in the <code>parent</code>, each of which correspond to a different orientation of the <code>query</code> overlaying that <code>parent</code> substructure. The function <code>nb_ori_at_loc</code> outputs a vector whose element <code>i_loc</code> is the number of overlay orientations at that location.</p><pre><code class="language-julia hljs">nb_ori_at_loc(search)  # 24-element Vector{Int64}: [4, 4, 4, ..., 4]</code></pre><p>Each individual isomorphism <code>isom = search.isomorphisms[i_loc][i_ori]</code> for a specific location <code>i_loc</code> and orientation <code>i_ori</code> indicates the correspondence from the <code>query</code> to the <code>parent</code> struture: if atom <code>q</code> of the <code>query</code> maps to atom <code>p</code> of the <code>parent</code>, then <code>isom[q] == p</code>.</p><p>The total number of isomorphisms is given by <code>nb_isomorphisms(search)</code>.</p><pre><code class="language-julia hljs">nb_isomorphisms(search) # = sum(nb_ori_at_loc(search))
# output
96</code></pre><p>N.b. to generate a <code>Crystal</code> containing only the substructures of the <code>parent</code> which are isomorphic to the <code>query</code>, use:</p><pre><code class="language-julia hljs">isomorphic_substructures(search)
# output
Name: IRMOF-1.cif
Bravais unit cell of a crystal.
	Unit cell angles α = 90.000000 deg. β = 90.000000 deg. γ = 90.000000 deg.
	Unit cell dimensions a = 25.832000 Å. b = 25.832000 Å, c = 25.832000 Å
	Volume of unit cell: 17237.492730 Å³

	# atoms = 240
	# charges = 0
	chemical formula: Dict(:H =&gt; 2, :C =&gt; 3)
	space Group: P1
	symmetry Operations:
		&#39;x, y, z&#39;
	bonding graph:
		# vertices = 240
		# edges = 240</code></pre><h2 id="Stereochemistry-and-Isomorphism"><a class="docs-heading-anchor" href="#Stereochemistry-and-Isomorphism">Stereochemistry and Isomorphism</a><a id="Stereochemistry-and-Isomorphism-1"></a><a class="docs-heading-anchor-permalink" href="#Stereochemistry-and-Isomorphism" title="Permalink"></a></h2><p>The node-labeled graph representation of a molecule/crystal structure is invariant with respect to stereochemistry. In other words, every rotational/conformational state and stereoisomer of a structure share the same graph representation. What this means is that <code>PoreMatMod.jl</code> may find more subgraph matches than you may first expect. </p><p><em>Example 1</em>: Suppose we search for a carboxylate with beta hydrogen in acrylate.</p><p><img src="../../assets/find/symmetry.png" alt="symmetry viz"/></p><p>There is clearly only one substructure of acrylate that matches the query. However, there are two subgraph isomorphisms, because swapping the oxygen atoms in the point cloud representation results in the same graph representation.  The above image gives a closer look at how these degenerate representations translate to multiple isomorphisms for a single occurence of a fragment in a structure.</p><p><em>Example 2</em>: Suppose we search the IRMOF-1 <code>parent</code> structure for the <a href="../../assets/find/BDC.xyz">BDC.xyz</a> linker as the <code>query</code> instead of the more minimal <em>p</em>-phenylene <code>query</code> fragment. Thanks to the two carboxyl groups, the total number of isomorphisms is multiplied by a factor of 4, due to the 180 degree rotation of these groups having no effect on the graph representation. The number of <em>locations</em> at which the isomorphisms are found, however, is unchanged.</p><pre><code class="language-julia hljs">query = moiety(&quot;BDC.xyz&quot;)
search = query ∈ parent
nb_isomorphisms(search) 
# output
384</code></pre><pre><code class="language-julia hljs">nb_locations(search) 
# output
24</code></pre><p><strong>Note</strong>: We advise to define the <code>query</code> using the most minimal structure that matches the targeted <code>parent</code> substructure.</p><h2 id="Documentation-for-functions"><a class="docs-heading-anchor" href="#Documentation-for-functions">Documentation for functions</a><a id="Documentation-for-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation-for-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.Search" href="#PoreMatMod.Search"><code>PoreMatMod.Search</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">search = Search(parent, query, results)</code></pre><p>Stores the <code>parent</code> and <code>query</code> used for a substructure search and the results (isomorphisms) of the subgraph matching algorithm.</p><p><strong>attributes</strong></p><ul><li><code>search.parent::Crystal</code>                           # the parent in the search</li><li><code>search.query::Crystal</code>                            # the query in the search</li><li><code>search.isomorphisms::Vector{Vector{Vector{Int}}}</code> # the query-to-parent correspondences</li></ul><p>The isomorphisms are grouped by location in the parent <code>Crystal</code> and can be examined using <code>nb_isomorphisms</code>, <code>nb_locations</code>, and <code>nb_ori_at_loc</code>.</p><p>Subgraph isomorphisms are encoded like</p><pre><code class="nohighlight hljs">isom = search.isomorphisms[i_loc][i_ori] = [7, 21, 9]</code></pre><p>where <code>isom[k]</code> is the index of the atom in <code>search.parent</code> corresponding to atom <code>k</code> in <code>search.query</code> for the isomorphism at location <code>i_loc</code> and orientation <code>i_ori</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.substructure_search" href="#PoreMatMod.substructure_search"><code>PoreMatMod.substructure_search</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">substructure_search(query, parent; disconnected_component=false)</code></pre><p>Searches for a substructure within a <code>Crystal</code> and returns a <code>Search</code> struct containing all identified subgraph isomorphisms.  Matches are made on the basis of atomic species and chemical bonding networks, including bonds across unit cell periodic boundaries.  The search moiety may optionally contain markup for designating atoms to replace with other moieties.</p><p><strong>Arguments</strong></p><ul><li><code>query::Crystal</code> the search moiety</li><li><code>parent::Crystal</code> the parent structure</li><li><code>disconnected_component::Bool=false</code> if true, disables substructure searching (e.g. for finding guest molecules)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L92-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.nb_ori_at_loc" href="#PoreMatMod.nb_ori_at_loc"><code>PoreMatMod.nb_ori_at_loc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nb_ori_at_loc(search)</code></pre><p>Returns a array containing the number of isomorphic configurations at a given location (collection of atoms) for which the specified <code>Search</code> results contain isomorphisms.</p><p><strong>Arguments</strong></p><ul><li><code>search::Search</code> a substructure <code>Search</code> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L58-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.nb_isomorphisms" href="#PoreMatMod.nb_isomorphisms"><code>PoreMatMod.nb_isomorphisms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nb_isomorphisms(search::Search)</code></pre><p>Returns the number of isomorphisms found in the specified <code>Search</code></p><p><strong>Arguments</strong></p><ul><li><code>search::Search</code> a substructure <code>Search</code> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L31-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.nb_locations" href="#PoreMatMod.nb_locations"><code>PoreMatMod.nb_locations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nb_locations(search::Search)</code></pre><p>Returns the number of unique locations in the <code>parent</code> (sets of atoms in the <code>parent</code>) at which the specified <code>Search</code> results contain isomorphisms.</p><p><strong>Arguments</strong></p><ul><li><code>search::Search</code> a substructure <code>Search</code> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L44-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PoreMatMod.isomorphic_substructures" href="#PoreMatMod.isomorphic_substructures"><code>PoreMatMod.isomorphic_substructures</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">iso_structs = isomorphic_substructures(s::Search)::Crystal</code></pre><p>Returns a crystal consisting of the atoms of the <code>parent</code> involved in subgraph isomorphisms in the search <code>s</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PoreMatMod.jl/blob/38b1bdc1971fad0eca7976ca03cb8184f7a18c5a/src/search.jl#L82-L86">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inputs/">« Loading Data</a><a class="docs-footer-nextpage" href="../replace/">Substructure Find/Replace »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 17 February 2022 06:38">Thursday 17 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
